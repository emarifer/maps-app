var z=Object.defineProperty,F=Object.defineProperties;var A=Object.getOwnPropertyDescriptors;var S=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,_=Object.prototype.propertyIsEnumerable;var k=(t,e,o)=>e in t?z(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,p=(t,e)=>{for(var o in e||(e={}))B.call(e,o)&&k(t,o,e[o]);if(S)for(var o of S(e))_.call(e,o)&&k(t,o,e[o]);return t},u=(t,e)=>F(t,A(e));import{r as c,a as N,j,m as f,S as J,R as Z,G as $,b as O,c as Y,d as G}from"./vendor.65e7615f.js";const H=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function o(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerpolicy&&(r.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?r.credentials="include":n.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(n){if(n.ep)return;n.ep=!0;const r=o(n);fetch(n.href,r)}};H();const y=c.exports.createContext({}),U=async()=>new Promise((t,e)=>{navigator.geolocation.getCurrentPosition(({coords:o})=>{t([o.longitude,o.latitude])},o=>{alert("Could not get geolocation"),console.error(o),e()})}),W=(t,e)=>{switch(e.type){case"setUserLocation":return u(p({},t),{isLoading:!1,userLocation:e.payload});case"setLoadingPlaces":return u(p({},t),{isLoadingPlaces:!0,places:[]});case"setPlaces":return u(p({},t),{isLoadingPlaces:!1,places:e.payload});case"setShowListPlaces":return u(p({},t),{showListPlaces:!t.showListPlaces});default:return t}},X=N.create({baseURL:"https://api.mapbox.com/directions/v5/mapbox/driving",params:{alternatives:!1,geometries:"geojson",overview:"simplified",steps:!1,access_token:"pk.eyJ1IjoiZW1hcmlmZXIiLCJhIjoiY2t5MDZ5aW4wMDBhdDJwbzRuMmpuZnIxNCJ9.YgX2fl2_DmbFDztFOn4HGg"}}),Q=N.create({baseURL:"https://api.mapbox.com/geocoding/v5/mapbox.places",params:{limit:5,language:"es",access_token:"pk.eyJ1IjoiZW1hcmlmZXIiLCJhIjoiY2t5MDZ5aW4wMDBhdDJwbzRuMmpuZnIxNCJ9.YgX2fl2_DmbFDztFOn4HGg"}}),s=j.exports.jsx,m=j.exports.jsxs,K={isLoading:!0,userLocation:void 0,isLoadingPlaces:!1,showListPlaces:!1,places:[]},V=({children:t})=>{const[e,o]=c.exports.useReducer(W,K);c.exports.useEffect(()=>{U().then(r=>o({type:"setUserLocation",payload:r}))},[]);const i=async r=>{if(r.length===0)return o({type:"setPlaces",payload:[]}),[];if(!e.userLocation)throw new Error("No user location");o({type:"setLoadingPlaces"});const a=await Q.get(`/${r}.json`,{params:{proximity:e.userLocation.join(",")}});return o({type:"setPlaces",payload:a.data.features}),a.data.features},n=()=>o({type:"setShowListPlaces"});return s(y.Provider,{value:u(p({},e),{searchPlacesByTerms:i,setShowListPlaces:n}),children:t})},v=c.exports.createContext({}),q=(t,e)=>{switch(e.type){case"setMap":return u(p({},t),{isMapReady:!0,map:e.payload});case"setMarkers":return u(p({},t),{markers:e.payload});default:return t}};const ee={isMapReady:!1,map:void 0,markers:[]},te=({children:t})=>{const[e,o]=c.exports.useReducer(q,ee),{places:i}=c.exports.useContext(y);c.exports.useEffect(()=>{e.markers.forEach(d=>d.remove());const a=[];for(const d of i)if(e.map){const[g,L]=d.center,l=new f.exports.Popup().setHTML(`
					<h6>${d.text_es}</h6>
					<p>${d.place_name_es}</p>
				`),h=new f.exports.Marker({color:"#1fa01a"}).setLngLat([g,L]).setPopup(l).addTo(e.map);a.push(h)}o({type:"setMarkers",payload:a})},[i]);const n=a=>{const d=new f.exports.Popup().setHTML(`
			<h4>Esta es mi ubicaci\xF3n</h4>
			<p>En alg\xFAn lugar de Sevilla\u2026</p>
		`);new f.exports.Marker({color:"#8a2be2"}).setLngLat(a.getCenter()).setPopup(d).addTo(a);const g=new f.exports.ScaleControl;a.addControl(g),o({type:"setMap",payload:a})},r=async(a,d)=>{var b,P,M,C;const g=await X.get(`${a.join(",")};${d.join(",")}`),{distance:L,duration:l,geometry:h}=g.data.routes[0],{coordinates:x}=h,I=Math.round(L/1e3*100)/100,T=Math.round(l/60*100)/100;J.fire({heightAuto:!1,icon:"info",title:"Route information",html:`<b>Distance</b>: ${I} km<br /><b>Duration</b>: ${T} min`,position:"bottom-end",allowOutsideClick:!1});const w=new f.exports.LngLatBounds(a,a);x.forEach(R=>{const E=[R[0],R[1]];w.extend(E)}),(b=e.map)==null||b.fitBounds(w,{padding:100});const D={type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:x}}]}};((P=e.map)==null?void 0:P.getLayer("RouteString"))&&(e.map.removeLayer("RouteString"),e.map.removeSource("RouteString")),(M=e.map)==null||M.addSource("RouteString",D),(C=e.map)==null||C.addLayer({id:"RouteString",type:"line",source:"RouteString",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"blue","line-width":4}})};return s(v.Provider,{value:u(p({},e),{setMap:n,getRouteBetweenPoints:r}),children:t})},oe=()=>{const{map:t,isMapReady:e}=c.exports.useContext(v),{userLocation:o}=c.exports.useContext(y);return s("button",{onClick:()=>{if(!e)throw new Error("The map is not ready");if(!o)throw new Error("No user location");t==null||t.flyTo({zoom:14,center:o})},title:"My Location",className:"btn btn-primary",style:{position:"fixed",top:"20px",right:"20px",zIndex:999},children:s(Z,{style:{width:"3rem",height:"2rem"}})})};const se=()=>m("div",{className:"loading-map d-flex justify-content-center align-items-center flex-column",children:[m("div",{className:"lds-ring",children:[s("div",{}),s("div",{}),s("div",{}),s("div",{})]}),s("div",{className:"mt-3",children:"Locating\u2026"})]}),ne=()=>{const{isLoading:t,userLocation:e}=c.exports.useContext(y),{setMap:o}=c.exports.useContext(v),i=c.exports.useRef(null);return c.exports.useLayoutEffect(()=>{var n;if(!t){const r=new f.exports.Map({container:(n=i==null?void 0:i.current)!=null?n:"",style:"mapbox://styles/mapbox/streets-v11",center:e,zoom:14});o(r)}},[t]),s("div",{ref:i,style:{height:"100vh",left:0,position:"fixed",top:0,width:"100vw"},children:t?s(se,{}):e==null?void 0:e.join(",")})};var re="/maps-app/assets/logo.df7320db.svg";const ae=()=>s("img",{src:re,alt:"React Logo",style:{position:"fixed",bottom:"20px",right:"20px",width:"130px"}});function ie(t){return $({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M396 512a112 112 0 1 0 224 0 112 112 0 1 0-224 0zm546.2-25.8C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 0 0 0 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3 7.7-16.2 7.7-35 0-51.5zM508 688c-97.2 0-176-78.8-176-176s78.8-176 176-176 176 78.8 176 176-78.8 176-176 176z"}}]})(t)}const ce=()=>{const{searchPlacesByTerms:t,setShowListPlaces:e,showListPlaces:o}=c.exports.useContext(y),i=c.exports.useRef();return m("div",{className:"search-container",style:o?{}:{paddingTop:"0px"},children:[m("div",{className:"search-control",children:[s("input",{onChange:r=>{i.current&&clearTimeout(i.current),i.current=setTimeout(()=>{t(r.target.value)},1e3)},type:"text",className:"form-control",placeholder:"Find a place\u2026"}),s("div",{className:"show-icon",children:s(ie,{onClick:e})})]}),o&&s(le,{})]})},le=()=>{const{places:t,isLoadingPlaces:e,userLocation:o,setShowListPlaces:i}=c.exports.useContext(y),{map:n,getRouteBetweenPoints:r}=c.exports.useContext(v),[a,d]=c.exports.useState(""),g=l=>{d(l.id);const[h,x]=l.center;n==null||n.flyTo({zoom:14,center:[h,x]})},L=l=>{if(!o)return;const[h,x]=l.center;r(o,[h,x]),i()};return e?m("div",{className:"d-flex justify-content-center align-items-center flex-column",children:[m("div",{className:"lds-ring",children:[s("div",{}),s("div",{}),s("div",{}),s("div",{})]}),s("div",{className:"mt-3",children:"Locating places\u2026"})]}):s("ul",{className:`list-group ${t.length===0?"":"mt-3"}`,children:t.map(l=>m("li",{onClick:()=>g(l),className:`list-group-item list-group-item-action pointer ${a===l.id?"active":""}`,children:[s("h6",{children:l.text_es}),s("p",{style:{fontSize:"12px"},children:l.place_name}),s("button",{onClick:()=>L(l),className:`btn btn-sm ${a===l.id?"btn-outline-light":"btn-outline-primary"}`,children:"Addresses"})]},l.id))})},de=()=>m("div",{children:[s(ne,{}),s(oe,{}),s(ae,{}),s(ce,{})]}),pe=()=>s(V,{children:s(te,{children:s(de,{})})});O.accessToken="pk.eyJ1IjoiZW1hcmlmZXIiLCJhIjoiY2t5MDZ5aW4wMDBhdDJwbzRuMmpuZnIxNCJ9.YgX2fl2_DmbFDztFOn4HGg";if(!navigator.geolocation)throw alert("Your browser does not have a geolocation option"),new Error("Your browser does not have a geolocation option");Y.render(s(G.StrictMode,{children:s(pe,{})}),document.getElementById("root"));
